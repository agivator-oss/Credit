<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Credit Checklist (Static)</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="app">
    <header class="toolbar" role="banner">
      <div class="toolbar-left">
        <div class="app-title">Private Credit — Credit Checklist</div>
        <div class="app-subtitle">Static (open <span class="mono">index.html</span>) • No backend • No libraries</div>
      </div>

      <div class="toolbar-actions">
        <input id="dealFileInput" type="file" accept="application/json,.json" hidden />
        <button class="btn" id="btnUploadDeal" type="button">Upload Deal File</button>
        <button class="btn" id="btnLoadSample" type="button">Load Sample Deal</button>
        <button class="btn" id="btnAudit" type="button">Checklist Audit</button>
        <span class="deal-pill" id="dealPill" aria-label="Active deal">Deal: <span class="mono" id="dealIdLabel">local-demo</span></span>
        <button class="btn" id="btnSave" type="button">Save</button>
        <button class="btn" id="btnReset" type="button">Reset to defaults</button>
        <button class="btn" id="btnClearSaved" type="button">Clear saved state</button>
        <button class="btn" id="btnExportCsv" type="button">Export to CSV</button>
        <button class="btn primary" id="btnExportChecklist" type="button">Export to JSON</button>
      </div>
    </header>

    <main class="sheet" role="main" aria-label="Spreadsheet">
      <div class="sheet-header">
        <div class="sheet-title" aria-label="Sheet title">Credit Checklist</div>
        <div class="sheet-meta" id="sheetMeta">Ready</div>
      </div>

      <div class="banner" id="rowCountBanner" role="status" aria-live="polite"></div>
      <div class="banner sub" id="autofillBanner" role="status" aria-live="polite"></div>

      <div class="grid-wrap" role="region" aria-label="Credit Checklist table" tabindex="0">
        <table class="grid" aria-label="Credit Checklist">
          <colgroup>
            <col class="col-item" />
            <col class="col-status" />
            <col class="col-check" />
            <col class="col-comments" />
          </colgroup>
          <thead>
            <tr>
              <th scope="col">ITEM / DESCRIPTION</th>
              <th scope="col">STATUS</th>
              <th scope="col">CHECK</th>
              <th scope="col">COMMENTS</th>
            </tr>
          </thead>
          <tbody id="gridBody">
            <!-- rendered by app.js -->
          </tbody>
        </table>
      </div>
    </main>

    <footer class="tabs" role="navigation" aria-label="Sheets">
      <button class="tab" type="button" data-sheet="ScenarioSub 2nd Mortgage">ScenarioSub 2nd Mortgage</button>
      <button class="tab" type="button" data-sheet="ScenarioSub Blended Mortgage">ScenarioSub Blended Mortgage</button>
      <button class="tab" type="button" data-sheet="Valuation Check">Valuation Check</button>
      <button class="tab active" type="button" data-sheet="Credit Checklist" aria-current="page">Credit Checklist</button>
      <button class="tab" type="button" data-sheet="Valuation Reliability Scorecard">Valuation Reliability Scorecard</button>
      <button class="tab" type="button" data-sheet="SOP">SOP</button>
      <button class="tab" type="button" data-sheet="Credit Committee Summary">Credit Committee Summary</button>
      <button class="tab" type="button" data-sheet="Upfront Legal Fees Invoice">Upfront Legal Fees Invoice</button>
    </footer>
  </div>

  <!-- Checklist Audit modal -->
  <div class="modal" id="auditModal" aria-hidden="true" role="dialog" aria-label="Checklist Audit">
    <div class="modal-panel">
      <div class="modal-header">
        <strong>Checklist Audit</strong>
        <div class="spacer"></div>
        <button class="btn" id="btnAuditClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <pre class="audit-pre" id="auditOutput" aria-label="Audit output"></pre>
      </div>
    </div>
  </div>

  <script type="module" src="./app.js"></script>
</body>
</html>
